---
- name: Execute Python script on Windows host as another user
  hosts: windows
  vars_files:
    - vault.yml
  tasks:
    - name: Run Python script as a different Windows user
      ansible.windows.win_shell: |
        runas /user:{{ vault_windows_username }} /savecred "python C:\\path\\to\\your\\script.py"
      args:
        stdin: "{{ vault_windows_password }}"
